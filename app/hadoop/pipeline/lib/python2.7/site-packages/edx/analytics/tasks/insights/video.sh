#!/bin/bash

source /edx/app/hadoop/pipeline/bin/activate



interval=2017-05-01-$(date +%Y-%m-%d)
overwritendays='807'
outputroot='hdfs://localhost:9000/edx-analytics-pipeline/video_viewing/output/'

PYTHONPATH='/edx/app/hadoop/pipeline/local/lib/python2.7/site-packages/edx/analytics/tasks/insights' \
luigi --module video InsertToMysqlAllVideoTask \
--remote-log-level "DEBUG" \
--overwrite-n-days $overwritendays \
--interval $interval



function allvideo()
{
PYTHONPATH='/edx/app/hadoop/pipeline/local/lib/python2.7/site-packages/edx/analytics/tasks/insights' luigi --module video $1 --remote-log-level "DEBUG" --overwrite-n-days $overwritendays --interval $interval
}

function video()
{
PYTHONPATH='/edx/app/hadoop/pipeline/local/lib/python2.7/site-packages/edx/analytics/tasks/insights' luigi --module video $1 --overwrite-n-days $overwritendays --interval $interval
}

function videoviewing()
{
PYTHONPATH='/edx/app/hadoop/pipeline/local/lib/python2.7/site-packages/edx/analytics/tasks/insights' luigi --module video $1 --interval $interval --output-root $outputroot
}

function videotimeline()
{
PYTHONPATH='/edx/app/hadoop/pipeline/local/lib/python2.7/site-packages/edx/analytics/tasks/insights' luigi --module video $1 --remote-log-level "DEBUG" --overwrite-n-days $overwritendays --interval $interval
}

#1
#videoviewing UserVideoViewingTask
#2
#allvideo InsertToMysqlAllVideoTask
#video InsertToMysqlVideoTask
#videotimeline InsertToMysqlVideoTimelineTask
