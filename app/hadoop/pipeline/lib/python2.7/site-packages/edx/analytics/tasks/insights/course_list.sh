#!/bin/bash
source /edx/app/hadoop/hadoop/etc/hadoop/hadoop-env.sh
source /edx/app/hadoop/hive/conf/hive-env.sh
source /edx/app/hadoop/sqoop/conf/sqoop-env.sh


source /edx/app/hadoop/pipeline/bin/activate

list=("PullCourseListApiData" "CourseMetaSummaryEnrollmentDataTask" "CourseListApiDataTask")


PYTHONPATH='/edx/app/hadoop/popeline/local/lib/python2.7/site-packages' \
luigi --module edx.analytics.tasks.insights.course_list CourseListApiDataTask \
--warehouse-path "hdfs://localhost:9000/edx-analytics-pipeline/warehouse/" \
--mapreduce-engine "hadoop"  \
--output-root "hdfs://localhost:9000/edx-analytics-pipeline/event-export/output" \
--overwrite



function listapidata()
{
PYTHONPATH='.' luigi --module course_list PullCourseListApiData --api-root-url "https://study.vhec.lk/api/courses/v1/courses" 
}

function apidatatask()
{
PYTHONPATH='/edx/app/hadoop/popeline/local/lib/python2.7/site-packages' luigi --module edx.analytics.tasks.insights.course_list CourseListApiDataTask --warehouse-path "hdfs://localhost:9000/edx-analytics-pipeline/warehouse/" --mapreduce-engine "hadoop"  --output-root "hdfs://localhost:9000/edx-analytics-pipeline/event-export/output" --overwrite
}

function courselisttable()
{
PYTHONPATH='.' luigi --module course_list CourseListTableTask --warehouse-path "hdfs://localhost:9000/edx-analytics-pipeline/warehouse/" --overwrite
}

#1
#apidatatask
#2
#courselisttable

#listapidata

#--additional-config "/edx/app/hadoop/edx-analytics-pipeline/tasks/override.cfg"
#--n-reduce-tasks 1 \
#--mapreduce-engine hadoop \
#--pattern tracking.log \
#--destination "hdfs://localhost:9000/edx-analytics-pipeline/warehouse/" \
#--credentials "/edx/etc/edx-analytics-pipeline/input.json" \
#--database "edxapp"
#--date-interval 2012-06
#--source 'hdfs://localhost:9000/data/'  \
#--local-scheduler \

