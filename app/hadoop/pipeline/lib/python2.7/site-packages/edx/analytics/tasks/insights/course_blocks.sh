#!/bin/bash
source /edx/app/hadoop/hadoop/etc/hadoop/hadoop-env.sh
source /edx/app/hadoop/hive/conf/hive-env.sh
source /edx/app/hadoop/sqoop/conf/sqoop-env.sh


source /edx/app/hadoop/pipeline/bin/activate

list=("CourseListApiDataTask" "PullCourseBlocksApiData" "CourseBlocksApiDataTask" "PullCourseListApiData")

PYTHONPATH='/edx/app/hadoop/pipeline/local/lib/python2.7/site-packages/edx/analytics/tasks/' \
luigi --module insights.course_blocks PullCourseBlocksApiData \
--warehouse-path 'hdfs://localhost:9000/edx-analytics-pipeline/warehouse/' \
--input-root 'hdfs://localhost:9000/edx-analytics-pipeline/event-import/input/' \
--api-root-url 'https://study.vhec.lk/api/v0/blocks' 



function pullcourseblocksapidata()
{
PYTHONPATH='.' luigi --module course_blocks PullCourseBlocksApiData --warehouse-path 'hdfs://localhost:9000/edx-analytics-pipeline/warehouse/' --input-root 'hdfs://localhost:9000/edx-analytics-pipeline/event-import/input/' --api-root-url 'https://study.vhec.lk/api/v0/blocks' 
}

function courselistapidatatask()
{
PYTHONPATH='/edx/app/hadoop/pipeline/local/lib/python2.7/site-packages/' luigi --module edx.analytics.tasks.insights.course_blocks CourseListApiDataTask --mapreduce-engine hadoop --warehouse-path 'hdfs://localhost:9000/edx-analytics-pipeline/warehouse/'  --output-root 'hdfs://localhost:9000/edx-analytics-pipeline/event-export/output/'
}

function courseblocksapidatatask()
{
PYTHONPATH='/edx/app/hadoop/pipeline/local/lib/python2.7/site-package/' luigi --module edx.analytics.tasks.insights.course_blocks CourseBlocksApiDataTask --mapreduce-engine hadoop --warehouse-path 'hdfs://localhost:9000/edx-analytics-pipeline/warehouse/'  --remote-log-level 1  --output-root 'hdfs://localhost:9000/edx-analytics-pipeline/event-export/output/' --input-root 'hdfs://localhost:9000/edx-analytics-pipeline/event-export-by-course'
}

function pullcourselistapidata()
{
PYTHONPATH='.' luigi --module course_blocks PullCourseListApiData --warehouse-path 'hdfs://localhost:9000/edx-analytics-pipeline/warehouse/' --api-root-url 'https://study.vhec.lk/api/v0/' 

}

#pullcourseblocksapidata
#courselistapidatatask
#courseblocksapidatatask
#pullcourselistapidata
