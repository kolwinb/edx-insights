#!/bin/bash
#!/usr/bin/python
source /edx/app/hadoop/hadoop/etc/hadoop/hadoop-env.sh
source /edx/app/hadoop/hive/conf/hive-env.sh
source /edx/app/hadoop/sqoop/conf/sqoop-env.sh

source /edx/app/hadoop/pipeline/bin/activate


marker='hdfs://localhost:9000/edx-analytics-pipeline/marker/'
outputroot='hdfs://localhost:9000/problem-response-reports/output/'
interval=2017-04-01-$(date +%Y-%m-%d)

PYTHONPATH='/edx/app/hadoop/pipeline/local/lib/python2.7/site-packages/edx/analytics/tasks/insights' \
luigi --module problem_response ProblemResponseReportTask \
--marker $marker \
--output-root $outputroot \
--overwrite
